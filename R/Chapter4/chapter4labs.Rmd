---
title: "ISLR Chapter4 "
author: "ACO"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: true
    toc_depth: '6'
  html_document:
    df_print: paged
    toc: true
    toc_depth: '6'
urlcolor: blue
subtitle: 'Classification'
---

\newpage
```{r, include=FALSE}
knitr::opts_chunk$set(echo = T, warning=FALSE,message=FALSE,attr.source='.numberLines',attr.output='.numberLines', fig.align='center', dpi=350, fig.width=15, fig.height=15)
```

# 4.7.1 The stock market data

```{r}
library(ISLR2)
```

```{r}
names(Smarket)
```

```{r}
pairs(Smarket)
```

```{r}
cor(Smarket[,-9])
```

\newpage
# 4.7.2 Logistic Regression

```{r}
glm.fits <- glm(
  Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume,
  data = Smarket , family = binomial
)
summary(glm.fits)
```

```{r}
glm_probs <- predict(glm.fits , type = "response")
glm_probs[1:10]
```

```{r}
contrasts(Smarket$Direction)
```

```{r}
glm_pred <- rep("Down", 1250)
glm_pred[glm_probs > .5] = "Up"
```

```{r}
table(glm_pred , Smarket$Direction)
```

```{r}
mean(glm_pred == Smarket$Direction)
```


```{r}
train <- Smarket$Year < 2005
Smarket_2005 <- Smarket[!train, ]
dim(Smarket_2005)
Direction_2005 <- Smarket_2005$Direction
```

```{r}
glm_fits <- glm(
  Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, 
  data = Smarket , family = binomial , subset = train
)
glm_probs <- predict(
  glm_fits , Smarket_2005,
  type = "response")
```

```{r}
glm_pred <- rep("Down", 252)
glm_pred[glm_probs > .5] = "Up"
table(glm_pred , Direction_2005)
#
mean(glm_pred == as.character(Direction_2005))
mean(glm_pred != as.character(Direction_2005))
```

```{r}
glm_fits <- glm(
  Direction~Lag1 + Lag2 , data = Smarket ,
  family = binomial , subset = train)
glm_probs <- predict(
  glm_fits , Smarket_2005,
  type = "response")
glm_pred <- rep("Down", 252)
glm_pred[glm_probs > .5] = "Up"
table(glm_pred , Direction_2005)
mean(glm_pred == Direction_2005)
```


```{r}
predict(
  glm_fits, newdata = data.frame(Lag1 = c(1.2, 1.5), Lag2 = c(1.1, -0.8)),
  type = "response"
)
```

\newpage
# 4.7.3 Linear Discriminant Analysis

```{r}
library(MASS)
lda_fit <- lda(Direction~Lag1+Lag2, data = Smarket, subset = train)
lda_fit
```


```{r}
plot(lda_fit)
```


```{r}
lda_pred = predict(lda_fit, Smarket_2005)
names(lda_pred)
```

```{r}
lda_class = lda_pred$class
table(lda_class, Direction_2005)
mean(lda_class == Direction_2005)
```

# 4.7.4 Quadratic Discriminant Analysis

```{r}
qda_fit <- qda(Direction~Lag1+Lag2, data = Smarket, subset = train)
qda_fit
```

```{r}
qda_pred = predict(qda_fit, Smarket_2005)
qda_class = qda_pred$class
table(qda_class, Direction_2005)
mean(qda_class == Direction_2005)
```

# 4.7.5 Naive Bayes

```{r}
library(e1071)
```

```{r}
nb_fit <- naiveBayes(
  Direction ~ Lag1 + Lag2, data = Smarket, 
  subset = train)
nb_fit
```

```{r}
mean(Smarket$Lag1[train][Smarket$Direction[train] == "Down"])
sd(Smarket$Lag1[train][Smarket$Direction[train] == "Down"])
```

```{r}
nb_class <- predict(nb_fit , Smarket_2005)
table(nb_class , Direction_2005)
mean(nb_class == Direction_2005)
```

```{r}
nb_preds <- predict(nb_fit , Smarket_2005, type = "raw")
nb_preds[1:5, ]
```

# 4.7.6 K-Nearest Neighbour









































