---
title: "ISLR Chapter4 "
author: "ACO"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: true
    toc_depth: '6'
  html_document:
    df_print: paged
    toc: true
    toc_depth: '6'
urlcolor: blue
subtitle: 'Classification'
---

\newpage
```{r, include=FALSE}
knitr::opts_chunk$set(echo = T, warning=FALSE,message=FALSE,attr.source='.numberLines',attr.output='.numberLines', fig.align='center', dpi=350, fig.width=15, fig.height=15)
```

# 4.7.1 The stock market data

```{r}
library(ISLR2)
```

```{r}
names(Smarket)
```

```{r}
pairs(Smarket)
```

```{r}
cor(Smarket[,-9])
```

## 4.7.2 Logistic Regression

```{r}
glm.fits <- glm(
  Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume,
  data = Smarket , family = binomial
)
summary(glm.fits)
```

```{r}
glm_probs <- predict(glm.fits , type = "response")
glm_probs[1:10]
```

```{r}
contrasts(Smarket$Direction)
```

```{r}
glm_pred <- rep("Down", 1250)
glm_pred[glm_probs > .5] = "Up"
```

```{r}
table(glm_pred , Smarket$Direction)
```

```{r}
mean(glm_pred == Smarket$Direction)
```





